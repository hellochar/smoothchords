(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,n){e.exports=n(34)},23:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var o=n(8),r=n.n(o),a=n(16),i=n.n(a),s=(n(23),n(1)),c=n(2),l=n(3),u=n(0),m=n(4),d=n(9),v=[{tenor:4,alto:8,inversion:"root",quality:"augmented"},{tenor:4,alto:7,inversion:"root",quality:"major"},{tenor:3,alto:7,inversion:"root",quality:"minor"},{tenor:3,alto:6,inversion:"root",quality:"diminished"},{tenor:5,alto:8,inversion:"first",quality:"minor"},{tenor:5,alto:9,inversion:"first",quality:"major"},{tenor:6,alto:9,inversion:"first",quality:"diminished"},{tenor:4,alto:9,inversion:"second",quality:"minor"},{tenor:3,alto:8,inversion:"second",quality:"major"},{tenor:3,alto:9,inversion:"second",quality:"diminished"}];function h(e,t){var n=e.sort(function(e,t){return e-t}).slice(0,3);if(!(n.length<3)){var o=n.map(function(e){return e-n[0]}),r=Object(d.a)(o,3),a=r[1],i=r[2],s=v.find(function(e){return e.tenor===a&&e.alto===i});if(s){var c=(("root"===s.inversion?n[0]:"first"===s.inversion?n[1]:n[2])-t.key)%12,l=t.semitones.indexOf(c);if(-1!==l)return{degree:l+1,inversion:s.inversion,quality:s.quality}}}}var f=n(7),p=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.chord,t=e.degree,n=e.quality,o=e.inversion;return r.a.createElement("div",{className:"chord"},r.a.createElement("span",{className:"chord-numeral"},this.renderRomanNumeral(n,t)),this.renderInversionSymbol(o))}},{key:"renderRomanNumeral",value:function(e,t){var n=("major"===e||"augmented"===e?"\u2160 \u2161 \u2162 \u2163 \u2164 \u2165 \u2166".split(" "):"\u2170 \u2171 \u2172 \u2173 \u2174 \u2175 \u2176".split(" "))[t-1];return"diminished"===e?n+"\u1d52":"augmented"===e?n+"+":n}},{key:"renderInversionSymbol",value:function(e){return"root"===e?null:"first"===e?r.a.createElement("span",{className:"inversion inversion-first"},r.a.createElement("sup",null,"6")):"second"===e?r.a.createElement("span",{className:"inversion inversion-second"},r.a.createElement("sup",null,"6"),r.a.createElement("br",null),r.a.createElement("sub",null,"4")):void 0}}]),t}(r.a.PureComponent),g={root:[{movement:"...",scaleDegreeOffset:1,newInversion:"root"},{movement:"d..",scaleDegreeOffset:3,newInversion:"first"},{movement:"dd.",scaleDegreeOffset:5,newInversion:"second"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"root"},{movement:"..u",scaleDegreeOffset:6,newInversion:"second"},{movement:".uu",scaleDegreeOffset:4,newInversion:"first"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"root"}],first:[{movement:"...",scaleDegreeOffset:1,newInversion:"first"},{movement:".d.",scaleDegreeOffset:3,newInversion:"second"},{movement:".dd",scaleDegreeOffset:5,newInversion:"root"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"first"},{movement:"u..",scaleDegreeOffset:6,newInversion:"root"},{movement:"u.u",scaleDegreeOffset:4,newInversion:"second"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"first"}],second:[{movement:"...",scaleDegreeOffset:1,newInversion:"second"},{movement:"..d",scaleDegreeOffset:3,newInversion:"root"},{movement:"d.d",scaleDegreeOffset:5,newInversion:"first"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"second"},{movement:".u.",scaleDegreeOffset:6,newInversion:"first"},{movement:"uu.",scaleDegreeOffset:4,newInversion:"root"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"second"}]};function O(e,t,n){var o=(e.degree-1+(t.scaleDegreeOffset-1))%7+1,r=n.chords[o-1];if(!r)throw new Error("bad");return Object(f.a)({},r,{inversion:t.newInversion})}var y=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.movement.split("").map(function(e,n){return r.a.cloneElement(t.mapping[e],{key:n})});return r.a.createElement("div",{className:"chord-movement"},e)}}]),t}(r.a.PureComponent);y.mapping={u:r.a.createElement("span",{className:"voice-movement"},"\u2191"),d:r.a.createElement("span",{className:"voice-movement"},"\u2193"),".":r.a.createElement("span",{className:"voice-movement"},"\u2022")};var b=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.option,t=e.destinationChord,n=e.motion;return r.a.createElement("div",{className:"motion-option"},r.a.createElement(p,{chord:t}),this.maybeRenderMovement(n))}},{key:"maybeRenderMovement",value:function(e){if("..."!==e.movement)return r.a.createElement(y,{movement:e.movement})}}]),t}(r.a.PureComponent),w=n(13),I=n.n(w),E=[0,1,2,3,4,5,6].map(function(e){return-Math.PI/2-e/7*Math.PI*2}),j=[1,4,7,3,6,2,5],D=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getDiatonicChord",value:function(e,t){return Object(f.a)({},this.props.scale.chords[e-1],{inversion:t})}},{key:"render",value:function(){var e,t,n=this,o=[],a=this.getDiatonicChord(this.props.chord.degree,this.props.chord.inversion),i=a.quality===this.props.chord.quality,s=(e=a,t=this.props.scale,g[e.inversion].map(function(n){return{chord:e,destinationChord:O(e,n,t),motion:n,scale:t}})),c=function(e){var t=Number(e),r=E[t],a=s.find(function(e){return e.destinationChord.degree===j[t]});if(!a)throw new Error("");var c=j[t]===n.props.chord.degree&&i;o.push(n.renderMotionOption(a,r,0,t,c))};for(var l in j)c(l);if(!i){var u={chord:this.props.chord,destinationChord:this.props.chord,motion:{movement:"...",newInversion:this.props.chord.inversion,scaleDegreeOffset:1},scale:this.props.scale},m=j.indexOf(a.degree),d=E[m],v=this.renderMotionOption(u,d,-75,m,!0);o.push(v)}return r.a.createElement("div",{className:"circle-of-fourths"},o)}},{key:"renderMotionOption",value:function(e,t,n,o,a){var i=Math.cos(t)*(200+n)+200,s=Math.sin(t)*(200+n)+200,c={transform:"translate(".concat(i,"px, ").concat(s,"px)")},l=I()("option-container",{active:a});return r.a.createElement("div",{className:l,style:c,key:o},a?r.a.createElement("div",{className:"active-ring"}):null,r.a.createElement(b,{option:e}))}}]),t}(r.a.PureComponent),k=n(10),M=n(14),C=(n(33),function(){function e(t,n,o){var r=this;Object(s.a)(this,e),this.semitones=t,this.key=n,this.name=o,this.chords=void 0,this.chords=t.map(function(e,t){var o=h([r.getOctaveRespectingPitch(t)+n,r.getOctaveRespectingPitch(t+2)+n,r.getOctaveRespectingPitch(t+4)+n],r);if(!o)throw new Error("couldn't detect chord");return o})}return Object(c.a)(e,[{key:"getOctaveRespectingPitch",value:function(e){var t=Math.floor(e/this.semitones.length),n=e%this.semitones.length;return this.semitones[n]+12*t}}]),e}()),N=new C([0,2,4,6,7,9,11],5,"F Lydian"),x=new C([0,2,4,5,7,9,11],0,"C Major"),q=new C([0,2,4,5,7,9,10],7,"G Mixolydian"),P=new C([0,2,3,5,7,9,10],2,"D Dorian"),A=new C([0,2,3,5,7,8,10],9,"A Minor"),R=new C([0,1,3,5,7,8,10],4,"E Phrygian"),S=new C([0,1,3,5,6,8,10],11,"B Locrian"),F={"F Lydian":N,"C Major":x,"G Mixolydian":q,"D Dorian":P,"A Minor":A,"E Phrygian":R,"B Locrian":S},B=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=[],t=36;t<=84;t++){var n=t%12,o=-1!==this.props.pitches.indexOf(t);-1!==x.semitones.indexOf(n)?e.push(r.a.createElement(G,{isActive:o,pitch:t,key:t})):e.push(r.a.createElement(L,{isActive:o,pitch:t,key:t}))}return r.a.createElement("div",{className:"piano"},e)}}]),t}(r.a.PureComponent),G=function(e){var t=e.isActive,n=e.pitch,o=I()("piano-key piano-key-white",{active:t});return r.a.createElement("div",{className:o},t?W(n):null)},L=function(e){var t=e.isActive,n=e.pitch,o=I()("piano-key piano-key-black",{active:t});return r.a.createElement("div",{className:o},t?W(n):null)},J=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function W(e){var t=J[e%12],n=Math.floor(e/12)-1;return"".concat(t).concat(n)}var T=function e(t){var n=this;Object(s.a)(this,e),this.onMidiNotes=t,this.midi=void 0,this.pitches=[],this.handleMIDISuccess=function(e){n.midi=e;for(var t=e.inputs.values(),o=t.next();o&&!o.done;o=t.next())o.value.onmidimessage=n.handleMIDIMessage},this.handleMIDIMessage=function(e){console.log(e.data);var t=e.data[0],o=e.data[1],r=e.data[2]/127;t>=144&&t<160?(n.pitches=[].concat(Object(k.a)(n.pitches),[o]),$.triggerAttack(W(o),r)):t>=128&&t<144&&(n.pitches=n.pitches.filter(function(e){return e!==o}),$.triggerRelease(W(o))),n.onMidiNotes(n.pitches.slice())},this.handleMIDIFailure=function(){console.warn("Did not recognise MIDI controller")},navigator.requestMIDIAccess?navigator.requestMIDIAccess({sysex:!1}).then(this.handleMIDISuccess,this.handleMIDIFailure):console.warn("No MIDI support in your browser")};M.c.lookAhead=0;var $=new M.a(M.b,{volume:0,detune:0,portamento:0,envelope:{attack:1e-4,attackCurve:"exponential",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.3},oscillator:{type:"fmtriangle16",harmonicity:1,modulationIndex:1.2,modulationType:"square"}}).toDestination(),z=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pitches:[],chord:x.chords[0],scale:x,soundEnabled:!0},n.noteCollector=void 0,n.handleMidiNotes=function(e){var t=h(e,n.state.scale);console.log("getting chord from",e,"got",t),t?n.setState({pitches:e,chord:t}):n.setState({pitches:e})},n.handleCheckboxClick=function(){n.setState({soundEnabled:!n.state.soundEnabled},function(){$.volume.value=n.state.soundEnabled?0:-1/0})},n.noteCollector=new T(n.handleMidiNotes),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"top-area"},r.a.createElement("textarea",{className:"scratchpad"}),r.a.createElement("select",{value:this.state.scale.name,onChange:function(t){return e.setState({scale:F[t.target.value]})}},Object.keys(F).map(function(e){return r.a.createElement("option",{value:e},e)})),r.a.createElement(D,{chord:this.state.chord,scale:this.state.scale}),r.a.createElement("div",{className:"sound-toggle"},r.a.createElement("input",{type:"checkbox",checked:this.state.soundEnabled,onClick:this.handleCheckboxClick}),"Sound")),r.a.createElement(B,{pitches:this.state.pitches}))}}]),t}(r.a.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[17,1,2]]]);
//# sourceMappingURL=main.559887a4.chunk.js.map