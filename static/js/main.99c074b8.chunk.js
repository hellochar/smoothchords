(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n(20)},18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(9),a=n.n(i),s=(n(18),n(1)),c=n(2),l=n(4),u=n(3),m=n(5),v=n(7),d=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.chord,t=e.degree,n=e.quality,r=e.inversion;return o.a.createElement("div",{className:"chord"},o.a.createElement("span",{className:"chord-numeral"},this.renderRomanNumeral(n,t)),this.renderInversionSymbol(r))}},{key:"renderRomanNumeral",value:function(e,t){var n=("major"===e||"augmented"===e?"\u2160 \u2161 \u2162 \u2163 \u2164 \u2165 \u2166".split(" "):"\u2170 \u2171 \u2172 \u2173 \u2174 \u2175 \u2176".split(" "))[t-1];return"diminished"===e?n+"\u1d52":"augmented"===e?n+"+":n}},{key:"renderInversionSymbol",value:function(e){return"root"===e?null:"first"===e?o.a.createElement("span",{className:"inversion inversion-first"},o.a.createElement("sup",null,"6")):"second"===e?o.a.createElement("span",{className:"inversion inversion-second"},o.a.createElement("sup",null,"6"),o.a.createElement("br",null),o.a.createElement("sub",null,"4")):void 0}}]),t}(o.a.PureComponent),h={root:[{movement:"...",scaleDegreeOffset:1,newInversion:"root"},{movement:"d..",scaleDegreeOffset:3,newInversion:"first"},{movement:"dd.",scaleDegreeOffset:5,newInversion:"second"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"root"},{movement:"..u",scaleDegreeOffset:6,newInversion:"second"},{movement:".uu",scaleDegreeOffset:4,newInversion:"first"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"root"}],first:[{movement:"...",scaleDegreeOffset:1,newInversion:"first"},{movement:".d.",scaleDegreeOffset:3,newInversion:"second"},{movement:".dd",scaleDegreeOffset:5,newInversion:"root"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"first"},{movement:"u..",scaleDegreeOffset:6,newInversion:"root"},{movement:"u.u",scaleDegreeOffset:4,newInversion:"second"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"first"}],second:[{movement:"...",scaleDegreeOffset:1,newInversion:"second"},{movement:"..d",scaleDegreeOffset:3,newInversion:"root"},{movement:"d.d",scaleDegreeOffset:5,newInversion:"first"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"second"},{movement:".u.",scaleDegreeOffset:6,newInversion:"first"},{movement:"uu.",scaleDegreeOffset:4,newInversion:"root"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"second"}]};function f(e,t,n){var r=(e.degree-1+(t.scaleDegreeOffset-1))%7+1,o=n.chords[r-1];if(!o)throw new Error("bad");return Object(v.a)({},o,{inversion:t.newInversion})}var p=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.movement.split("").map(function(e,n){return o.a.cloneElement(t.mapping[e],{key:n})});return o.a.createElement("div",{className:"chord-movement"},e)}}]),t}(o.a.PureComponent);p.mapping={u:o.a.createElement("span",{className:"voice-movement"},"\u2191"),d:o.a.createElement("span",{className:"voice-movement"},"\u2193"),".":o.a.createElement("span",{className:"voice-movement"},"\u2022")};var O=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.option,t=e.destinationChord,n=e.motion;return o.a.createElement("div",{className:"motion-option"},o.a.createElement(d,{chord:t}),this.maybeRenderMovement(n))}},{key:"maybeRenderMovement",value:function(e){if("..."!==e.movement)return o.a.createElement(p,{movement:e.movement})}}]),t}(o.a.PureComponent),g=n(6),y=n.n(g),w=[0,1,2,3,4,5,6].map(function(e){return-Math.PI/2-e/7*Math.PI*2}),b=[1,4,7,3,6,2,5],I=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getDiatonicChord",value:function(e,t){return Object(v.a)({},this.props.scale.chords[e-1],{inversion:t})}},{key:"render",value:function(){var e,t,n=this,r=[],i=this.getDiatonicChord(this.props.chord.degree,this.props.chord.inversion),a=i.quality===this.props.chord.quality,s=(e=i,t=this.props.scale,h[e.inversion].map(function(n){return{chord:e,destinationChord:f(e,n,t),motion:n,scale:t}})),c=function(e){var t=Number(e),o=w[t],i=s.find(function(e){return e.destinationChord.degree===b[t]});if(!i)throw new Error("");var c=b[t]===n.props.chord.degree&&a;r.push(n.renderMotionOption(i,o,0,t,c))};for(var l in b)c(l);if(!a){var u={chord:this.props.chord,destinationChord:this.props.chord,motion:{movement:"...",newInversion:this.props.chord.inversion,scaleDegreeOffset:1},scale:this.props.scale},m=b.indexOf(i.degree),v=w[m],d=this.renderMotionOption(u,v,-75,m,!0);r.push(d)}return o.a.createElement("div",{className:"circle-of-fourths"},r)}},{key:"renderMotionOption",value:function(e,t,n,r,i){var a=Math.cos(t)*(200+n)+200,s=Math.sin(t)*(200+n)+200,c={transform:"translate(".concat(a,"px, ").concat(s,"px)")},l=y()("option-container",{active:i});return o.a.createElement("div",{className:l,style:c,key:r},i?o.a.createElement("div",{className:"active-ring"}):null,o.a.createElement(O,{option:e}))}}]),t}(o.a.PureComponent),j=n(10),D=function e(t){var n=this;Object(s.a)(this,e),this.onMidiNotes=t,this.midi=void 0,this.pitches=[],this.handleMIDISuccess=function(e){n.midi=e;for(var t=e.inputs.values(),r=t.next();r&&!r.done;r=t.next())r.value.onmidimessage=n.handleMIDIMessage},this.handleMIDIMessage=function(e){console.log(e.data);var t=e.data[0],r=e.data[1];t>=144&&t<160?n.pitches=[].concat(Object(j.a)(n.pitches),[r]):t>=128&&t<144&&(n.pitches=n.pitches.filter(function(e){return e!==r})),n.onMidiNotes(n.pitches.slice())},this.handleMIDIFailure=function(){console.warn("Did not recognise MIDI controller")},navigator.requestMIDIAccess?navigator.requestMIDIAccess({sysex:!1}).then(this.handleMIDISuccess,this.handleMIDIFailure):console.warn("No MIDI support in your browser")},E=n(11),M=[{tenor:4,alto:8,inversion:"root",quality:"augmented"},{tenor:4,alto:7,inversion:"root",quality:"major"},{tenor:3,alto:7,inversion:"root",quality:"minor"},{tenor:3,alto:6,inversion:"root",quality:"diminished"},{tenor:5,alto:8,inversion:"first",quality:"minor"},{tenor:5,alto:9,inversion:"first",quality:"major"},{tenor:6,alto:9,inversion:"first",quality:"diminished"},{tenor:4,alto:9,inversion:"second",quality:"minor"},{tenor:3,alto:8,inversion:"second",quality:"major"},{tenor:3,alto:9,inversion:"second",quality:"diminished"}];function k(e,t){var n=e.sort(function(e,t){return e-t}).slice(0,3);if(!(n.length<3)){var r=n.map(function(e){return e-n[0]}),o=Object(E.a)(r,3),i=o[1],a=o[2],s=M.find(function(e){return e.tenor===i&&e.alto===a});if(s){var c=(("root"===s.inversion?n[0]:"first"===s.inversion?n[1]:n[2])-t.key)%12,l=t.semitones.indexOf(c);if(-1!==l)return{degree:l+1,inversion:s.inversion,quality:s.quality}}}}var N=function(){function e(t,n,r){var o=this;Object(s.a)(this,e),this.semitones=t,this.key=n,this.name=r,this.chords=void 0,this.chords=t.map(function(e,t){var r=k([o.getOctaveRespectingPitch(t)+n,o.getOctaveRespectingPitch(t+2)+n,o.getOctaveRespectingPitch(t+4)+n],o);if(!r)throw new Error("couldn't detect chord");return r})}return Object(c.a)(e,[{key:"getOctaveRespectingPitch",value:function(e){var t=Math.floor(e/this.semitones.length),n=e%this.semitones.length;return this.semitones[n]+12*t}}]),e}(),q=new N([0,2,4,6,7,9,11],5,"F Lydian"),C=new N([0,2,4,5,7,9,11],0,"C Major"),P=new N([0,2,4,5,7,9,10],7,"G Mixolydian"),x=new N([0,2,3,5,7,9,10],2,"D Dorian"),A=new N([0,2,3,5,7,8,10],9,"A Minor"),R=new N([0,1,3,5,7,8,10],4,"E Phrygian"),S=new N([0,1,3,5,6,8,10],11,"B Locrian"),B={"F Lydian":q,"C Major":C,"G Mixolydian":P,"D Dorian":x,"A Minor":A,"E Phrygian":R,"B Locrian":S},F=(n(19),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=[],t=36;t<=84;t++){var n=t%12,r=-1!==this.props.pitches.indexOf(t);-1!==C.semitones.indexOf(n)?e.push(o.a.createElement(L,{isActive:r,key:t})):e.push(o.a.createElement(G,{isActive:r,key:t}))}return o.a.createElement("div",{className:"piano"},e)}}]),t}(o.a.PureComponent)),L=function(e){var t=e.isActive,n=y()("piano-key piano-key-white",{active:t});return o.a.createElement("div",{className:n})},G=function(e){var t=e.isActive,n=y()("piano-key piano-key-black",{active:t});return o.a.createElement("div",{className:n})},J=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={pitches:[],chord:C.chords[0],scale:C},n.noteCollector=void 0,n.handleMidiNotes=function(e){var t=k(e,n.state.scale);console.log("getting chord from",e,"got",t),t?n.setState({pitches:e,chord:t}):n.setState({pitches:e})},n.noteCollector=new D(n.handleMidiNotes),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"top-area"},o.a.createElement("textarea",{className:"scratchpad"}),o.a.createElement("select",{value:this.state.scale.name,onChange:function(t){return e.setState({scale:B[t.target.value]})}},Object.keys(B).map(function(e){return o.a.createElement("option",{value:e},e)})),o.a.createElement(I,{chord:this.state.chord,scale:this.state.scale})),o.a.createElement(F,{pitches:this.state.pitches}))}}]),t}(o.a.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,1,2]]]);
//# sourceMappingURL=main.99c074b8.chunk.js.map