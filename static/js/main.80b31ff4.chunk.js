(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,n,t){e.exports=t(20)},18:function(e,n,t){},19:function(e,n,t){},20:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r),i=t(9),a=t.n(i),s=(t(18),t(1)),c=t(2),l=t(4),u=t(3),m=t(5),v=t(7),d=function(e){function n(){return Object(s.a)(this,n),Object(l.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(m.a)(n,e),Object(c.a)(n,[{key:"render",value:function(){var e=this.props.chord,n=e.degree,t=e.quality,r=e.inversion;return o.a.createElement("div",{className:"chord"},o.a.createElement("span",{className:"chord-numeral"},this.renderRomanNumeral(t,n)),this.renderInversionSymbol(r))}},{key:"renderRomanNumeral",value:function(e,n){var t=("major"===e||"augmented"===e?"\u2160 \u2161 \u2162 \u2163 \u2164 \u2165 \u2166".split(" "):"\u2170 \u2171 \u2172 \u2173 \u2174 \u2175 \u2176".split(" "))[n-1];return"diminished"===e?t+"\u1d52":"augmented"===e?t+"+":t}},{key:"renderInversionSymbol",value:function(e){return"root"===e?null:"first"===e?o.a.createElement("span",{className:"inversion inversion-first"},o.a.createElement("sup",null,"6")):"second"===e?o.a.createElement("span",{className:"inversion inversion-second"},o.a.createElement("sup",null,"6"),o.a.createElement("br",null),o.a.createElement("sub",null,"4")):void 0}}]),n}(o.a.PureComponent),h={root:[{movement:"...",scaleDegreeOffset:1,newInversion:"root"},{movement:"d..",scaleDegreeOffset:3,newInversion:"first"},{movement:"dd.",scaleDegreeOffset:5,newInversion:"second"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"root"},{movement:"..u",scaleDegreeOffset:6,newInversion:"second"},{movement:".uu",scaleDegreeOffset:4,newInversion:"first"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"root"}],first:[{movement:"...",scaleDegreeOffset:1,newInversion:"first"},{movement:".d.",scaleDegreeOffset:3,newInversion:"second"},{movement:".dd",scaleDegreeOffset:5,newInversion:"root"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"first"},{movement:"u..",scaleDegreeOffset:6,newInversion:"root"},{movement:"u.u",scaleDegreeOffset:4,newInversion:"second"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"first"}],second:[{movement:"...",scaleDegreeOffset:1,newInversion:"second"},{movement:"..d",scaleDegreeOffset:3,newInversion:"root"},{movement:"d.d",scaleDegreeOffset:5,newInversion:"first"},{movement:"ddd",scaleDegreeOffset:7,newInversion:"second"},{movement:".u.",scaleDegreeOffset:6,newInversion:"first"},{movement:"uu.",scaleDegreeOffset:4,newInversion:"root"},{movement:"uuu",scaleDegreeOffset:2,newInversion:"second"}]};function f(e,n,t){var r=(e.degree-1+(n.scaleDegreeOffset-1))%7+1,o=t.chords[r-1];if(!o)throw new Error("bad");return Object(v.a)({},o,{inversion:n.newInversion})}var p=function(e){function n(){return Object(s.a)(this,n),Object(l.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(m.a)(n,e),Object(c.a)(n,[{key:"render",value:function(){var e=this.props.movement.split("").map(function(e,t){return o.a.cloneElement(n.mapping[e],{key:t})});return o.a.createElement("div",{className:"chord-movement"},e)}}]),n}(o.a.PureComponent);p.mapping={u:o.a.createElement("span",{className:"voice-movement"},"\u2191"),d:o.a.createElement("span",{className:"voice-movement"},"\u2193"),".":o.a.createElement("span",{className:"voice-movement"},"\u2022")};var O=function(e){function n(){return Object(s.a)(this,n),Object(l.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(m.a)(n,e),Object(c.a)(n,[{key:"render",value:function(){var e=this.props.option,n=e.destinationChord,t=e.motion;return o.a.createElement("div",{className:"motion-option"},o.a.createElement(d,{chord:n}),this.maybeRenderMovement(t))}},{key:"maybeRenderMovement",value:function(e){if("..."!==e.movement)return o.a.createElement(p,{movement:e.movement})}}]),n}(o.a.PureComponent),g=t(6),y=t.n(g),w=[0,1,2,3,4,5,6].map(function(e){return-Math.PI/2-e/7*Math.PI*2}),b=[1,4,7,3,6,2,5],I=function(e){function n(){return Object(s.a)(this,n),Object(l.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(m.a)(n,e),Object(c.a)(n,[{key:"getDiatonicChord",value:function(e,n){return Object(v.a)({},this.props.scale.chords[e-1],{inversion:n})}},{key:"render",value:function(){var e,n,t=this,r=[],i=this.getDiatonicChord(this.props.chord.degree,this.props.chord.inversion),a=i.quality===this.props.chord.quality,s=(e=i,n=this.props.scale,h[e.inversion].map(function(t){return{chord:e,destinationChord:f(e,t,n),motion:t,scale:n}})),c=function(e){var n=Number(e),o=w[n],i=s.find(function(e){return e.destinationChord.degree===b[n]});if(!i)throw new Error("");var c=b[n]===t.props.chord.degree&&a;r.push(t.renderMotionOption(i,o,0,n,c))};for(var l in b)c(l);if(!a){var u={chord:this.props.chord,destinationChord:this.props.chord,motion:{movement:"...",newInversion:this.props.chord.inversion,scaleDegreeOffset:1},scale:this.props.scale},m=b.indexOf(i.degree),v=w[m],d=this.renderMotionOption(u,v,-75,m,!0);r.push(d)}return o.a.createElement("div",{className:"circle-of-fourths"},r)}},{key:"renderMotionOption",value:function(e,n,t,r,i){var a=Math.cos(n)*(200+t)+200,s=Math.sin(n)*(200+t)+200,c={transform:"translate(".concat(a,"px, ").concat(s,"px)")},l=y()("option-container",{active:i});return o.a.createElement("div",{className:l,style:c,key:r},i?o.a.createElement("div",{className:"active-ring"}):null,o.a.createElement(O,{option:e}))}}]),n}(o.a.PureComponent),j=t(10),D=function e(n){var t=this;Object(s.a)(this,e),this.onMidiNotes=n,this.midi=void 0,this.pitches=[],this.handleMIDISuccess=function(e){t.midi=e;for(var n=e.inputs.values(),r=n.next();r&&!r.done;r=n.next())r.value.onmidimessage=t.handleMIDIMessage},this.handleMIDIMessage=function(e){console.log(e.data);var n=e.data[0],r=e.data[1];n>=144&&n<160?t.pitches=[].concat(Object(j.a)(t.pitches),[r]):n>=128&&n<144&&(t.pitches=t.pitches.filter(function(e){return e!==r})),t.onMidiNotes(t.pitches.slice())},this.handleMIDIFailure=function(){console.warn("Did not recognise MIDI controller")},navigator.requestMIDIAccess?navigator.requestMIDIAccess({sysex:!1}).then(this.handleMIDISuccess,this.handleMIDIFailure):console.warn("No MIDI support in your browser")},E=t(11),M=[{tenor:4,alto:8,inversion:"root",quality:"augmented"},{tenor:4,alto:7,inversion:"root",quality:"major"},{tenor:3,alto:7,inversion:"root",quality:"minor"},{tenor:3,alto:6,inversion:"root",quality:"diminished"},{tenor:5,alto:8,inversion:"first",quality:"minor"},{tenor:5,alto:9,inversion:"first",quality:"major"},{tenor:6,alto:9,inversion:"first",quality:"diminished"},{tenor:4,alto:9,inversion:"second",quality:"minor"},{tenor:3,alto:8,inversion:"second",quality:"major"},{tenor:3,alto:9,inversion:"second",quality:"diminished"}];function k(e,n){var t=e.sort(function(e,n){return e-n}).slice(0,3);if(!(t.length<3)){var r=t.map(function(e){return e-t[0]}),o=Object(E.a)(r,3),i=o[1],a=o[2],s=M.find(function(e){return e.tenor===i&&e.alto===a});if(s){var c=(("root"===s.inversion?t[0]:"first"===s.inversion?t[1]:t[2])-n.key)%12,l=n.semitones.indexOf(c);if(-1!==l)return{degree:l+1,inversion:s.inversion,quality:s.quality}}}}var N=function(){function e(n,t,r){var o=this;Object(s.a)(this,e),this.semitones=n,this.key=t,this.name=r,this.chords=void 0,this.chords=n.map(function(e,n){var r=k([o.getOctaveRespectingPitch(n)+t,o.getOctaveRespectingPitch(n+2)+t,o.getOctaveRespectingPitch(n+4)+t],o);if(!r)throw new Error("couldn't detect chord");return r})}return Object(c.a)(e,[{key:"getOctaveRespectingPitch",value:function(e){var n=Math.floor(e/this.semitones.length),t=e%this.semitones.length;return this.semitones[t]+12*n}}]),e}(),q=new N([0,2,4,6,7,9,11],5,"F Lydian"),C=new N([0,2,4,5,7,9,11],0,"C Major"),P=new N([0,2,4,5,7,9,10],7,"G Mixolydian"),x=new N([0,2,3,5,7,9,10],2,"D Dorian"),A=new N([0,2,3,5,7,8,10],9,"A Minor"),R=new N([0,1,3,5,7,8,10],4,"E Phrygian"),S=new N([0,1,3,5,6,8,10],11,"B Locrian"),B={"F Lydian":q,"C Major":C,"G Mixolydian":P,"D Dorian":x,"A Minor":A,"E Phrygian":R,"B Locrian":S},F=(t(19),function(e){function n(){return Object(s.a)(this,n),Object(l.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(m.a)(n,e),Object(c.a)(n,[{key:"render",value:function(){for(var e=[],n=36;n<=84;n++){var t=n%12,r=-1!==this.props.pitches.indexOf(n);-1!==C.semitones.indexOf(t)?e.push(o.a.createElement(L,{isActive:r,key:n})):e.push(o.a.createElement(G,{isActive:r,key:n}))}return o.a.createElement("div",{className:"piano"},e)}}]),n}(o.a.PureComponent)),L=function(e){var n=e.isActive,t=y()("piano-key piano-key-white",{active:n});return o.a.createElement("div",{className:t})},G=function(e){var n=e.isActive,t=y()("piano-key piano-key-black",{active:n});return o.a.createElement("div",{className:t})},J=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(l.a)(this,Object(u.a)(n).call(this,e))).state={pitches:[],chord:C.chords[0],scale:C},t.noteCollector=void 0,t.handleMidiNotes=function(e){var n=k(e,t.state.scale);console.log("getting chord from",e,"got",n),n?t.setState({pitches:e,chord:n}):t.setState({pitches:e})},t.noteCollector=new D(t.handleMidiNotes),t}return Object(m.a)(n,e),Object(c.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"top-area"},o.a.createElement("select",{value:this.state.scale.name,onChange:function(n){return e.setState({scale:B[n.target.value]})}},Object.keys(B).map(function(e){return o.a.createElement("option",{value:e},e)})),o.a.createElement(I,{chord:this.state.chord,scale:this.state.scale})),o.a.createElement(F,{pitches:this.state.pitches}))}}]),n}(o.a.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(o.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,1,2]]]);
//# sourceMappingURL=main.80b31ff4.chunk.js.map